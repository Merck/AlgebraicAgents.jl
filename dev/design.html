<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Framework design · AlgebraicAgents.jl</title><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">AlgebraicAgents.jl</a></span></div><form class="docs-search" action="search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="index.html">API Documentation</a></li><li class="is-active"><a class="tocitem" href="design.html">Framework design</a><ul class="internal"><li><a class="tocitem" href="#Simulation-loop"><span>Simulation loop</span></a></li></ul></li><li><span class="tocitem">Integrations</span><ul><li><a class="tocitem" href="integrations/AgentsIntegration.html">Agents.jl Integration</a></li><li><a class="tocitem" href="integrations/SciMLIntegration.html">SciML Integration</a></li><li><a class="tocitem" href="integrations/AlgebraicDynamicsIntegration.html">AlgebraicDynamics.jl Integration</a></li></ul></li><li><span class="tocitem">Three Sketches</span><ul><li><a class="tocitem" href="sketches/agents.html">Agents.jl Integration</a></li><li><a class="tocitem" href="sketches/pharma.html">A Toy Pharma Model</a></li><li><a class="tocitem" href="sketches/sciml.html">SciML Integration</a></li><li><a class="tocitem" href="sketches/algebraicdynamics.html">Lotka-Voltera Two Ways</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="design.html">Framework design</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="design.html">Framework design</a></li></ul></nav><div class="docs-right"><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Framework-design"><a class="docs-heading-anchor" href="#Framework-design">Framework design</a><a id="Framework-design-1"></a><a class="docs-heading-anchor-permalink" href="#Framework-design" title="Permalink"></a></h1><p>Here we describe the design principles of the AlgebraicAgents. It should be of most use to advanced users and persons interested in contributing to the software. New users are encouraged to start by reading one of the tutorials (&quot;sketches&quot;).</p><h2 id="Simulation-loop"><a class="docs-heading-anchor" href="#Simulation-loop">Simulation loop</a><a id="Simulation-loop-1"></a><a class="docs-heading-anchor-permalink" href="#Simulation-loop" title="Permalink"></a></h2><p>We describe here the main simulation loop which steps models built in AlgebraicAgents forward in time.</p><p>AlgebraicAgents keeps agents synchronized by ensuring that the model will only simulate the agent(s) whose projected time (e.g. the maximum time for which that agent&#39;s trajectory has been solved) is the minimum of all agents. For example, if there are 3 agents, whose internal step sizes are of 1, 1.5, and 3 time units, respectively, then at the end of the first step, their projected time will be 1, 1.5, and 3 (assuming they all start at time 0). The simulation will find the minimum of those times and only simulate the agent(s) whose projected time(s) are equal to the minimum. In this case, it is the first agent, who is now projected to time 2 on the second step (other agents are not simulated). Now, the new minimum time is 1.5, and the second agent is projected to time 3 on the third step, etc. The simulation continues until all agents have been projected to their final time point, or the minimum of projected times reaches a maximum time horizon. If all agents take time steps of the same size, then they will all be updated each global step.</p><p>There are several functions in the interface for an <a href="index.html#AlgebraicAgents.AbstractAlgebraicAgent"><code>AbstractAlgebraicAgent</code></a> which implement these dynamics. When defining new agent types, one should implement the <a href="index.html#AlgebraicAgents._step!-Tuple{AbstractAlgebraicAgent}"><code>AlgebraicAgents._step!</code></a> method, which will step that agent forward if its projected time is equal to the least projected time, among all agents in the hierarchy. Agent types also need to implement <a href="index.html#AlgebraicAgents._projected_to-Tuple{AbstractAlgebraicAgent}"><code>AlgebraicAgents._projected_to</code></a>, which is crucial to keeping the simulation synchronized. It will return:</p><ul><li><code>nothing</code> if the agent does not implement its own <code>_step!</code> rule (e.g. <a href="index.html#AlgebraicAgents.FreeAgent"><code>FreeAgent</code></a> which is a container of agents)</li><li><code>true</code> if the agent has been projected to the final time point (<code>_step!</code> will not be called again)</li><li>a value of <code>Number</code>, giving the time point to which the agent has been projected</li></ul><p>These are collected into <code>ret</code>, which is an object that will be <code>true</code> if and only if all agents have returned <code>true</code>, and is otherwise the minimum of the numeric values (projection times) returned from each inner agent&#39;s step.</p><p><img src="../assets/simloop.png" alt/></p><p>Above we show a caricature of the main simulation loop. &quot;Enter program&quot; corresponds to the call to <code>simulate</code>, the value of <code>ret</code> is (typically) initialized to <code>0.0</code>. The simulation continues to step while <code>ret</code> is not <code>true</code> (meaning the maximum time horizon has been reached by the slowest agent), or has not exceeded some maximum. </p><p>The inner area enclosed by a dashed border represents where program control is given to the <code>step!</code> method. The root agent applies <code>_prestep!</code> recurvisely to all of its inner (enclosed) agents. After this, <code>step!</code> is then applied to all inner agents, and <code>ret</code> is updated by each of them. Then the agent applies its own local update <code>_step!</code> if its own projected time is equal to the minimum of all inner agent projected times (not shown). Then the Opera module for additional interactions is called for the root agent.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="index.html">« API Documentation</a><a class="docs-footer-nextpage" href="integrations/AgentsIntegration.html">Agents.jl Integration »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Sunday 22 January 2023 16:39">Sunday 22 January 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
